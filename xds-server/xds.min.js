var xds=function(e){this.serverUrl=e;this.server=false;this.serverFrame=false;this._id=0;this.callbacks=[];this.queue=[];this.init()};xds.prototype={constructor:xds,init:function(){if(this.server||this.serverFrame){return}this.serverFrame=window.document.createElement("iframe");this.serverFrame.style.position="absolute";this.serverFrame.style.left=this.serverFrame.style.top="-999";var e=this;if(window.addEventListener){window.addEventListener("message",function(t){e.onMessage(t)},false)}else{window.attachEvent("onmessage",function(t){e.onMessage(t)})}window.document.body.appendChild(this.serverFrame);this.serverFrame.src=this.serverUrl},onMessage:function(e){response=JSON.parse(e.data);if(response.ready===true){this.server=this.serverFrame.contentWindow;this.processQueue();return}else if(response.type==="get"){if(typeof this.callbacks[response._xds]!=="undefined"){this.callbacks[response._xds](response.val,response)}}else if(response.type==="set"){if(typeof this.callbacks[response._xds]!=="undefined"){this.callbacks[response._xds](response)}}else if(response.type==="del"){if(typeof this.callbacks[response._xds]!=="undefined"){this.callbacks[response._xds](response)}}},processQueue:function(){if(!this.queue){return}if(!this.server){this.init();return}while(this.queue.length>0){this.server.postMessage(JSON.stringify(this.queue.shift()),"*")}},post:function(e,t){this._id++;e._xds=this._id;if(typeof t!=="undefined"&&t!==null&&t!==false){this.callbacks[this._id]=t}if(this.server){this.server.postMessage(JSON.stringify(e),"*")}else{this.queue.push(e);this.init()}},getItem:function(e,t){this.post({type:"get",key:e},t)},setItem:function(e,t,n){this.post({type:"set",key:e,val:t},n)},removeItem:function(e,t){this.post({type:"del",key:e},t)},getObject:function(e,t){this.getItem(e,function(e,n){t(e&&JSON.parse(e),n)})},setObject:function(e,t,n){this.setItem(e,JSON.stringify(t),n)},removeObject:function(e,t){this.removeItem(e,t)}}